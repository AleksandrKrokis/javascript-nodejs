extends /layouts/main

block append variables

  - var layout_header_class = "main__header_center"
  - var layout_main_class = "main_width-limit"
  - var breadcrumbs = [{ title: 'Учебник', url: '/' }, { title: 'Курсы', url: '/courses' }, { title: course.title, url: course.getUrl() }]
  - var content_class = '_center'
  - var siteToolbarCurrentSection = "courses"
  - var sitetoolbar = true
  - var statsBarLength = 240

block append head
  !=js("coursesFeedbackList", {defer: true})


block content

  script var feedbackStats = !{escapeJSON(stats)};

  +b.feedback-stat
    +e('ul').list
      +e('li').item(data-stars-title=5) Отлично
        +e('span').status
          +e('span').status-i(style="width: " + stats.stars[5].fraction * statsBarLength + "px")
      +e('li').item(data-stars-title=4) Хорошо
        +e('span').status
          +e('span').status-i(style="width: " + stats.stars[4].fraction * statsBarLength + "px")
      +e('li').item(data-stars-title=3) Нормально
        +e('span').status
          +e('span').status-i(style="width: " + stats.stars[3].fraction * statsBarLength + "px")
      +e('li').item(data-stars-title=2) Так себе
        +e('span').status
          +e('span').status-i(style="width: " + stats.stars[2].fraction * statsBarLength + "px")
      +e('li').item(data-stars-title=1) Плохо
        +e('span').status
          +e('span').status-i(style="width: " + stats.stars[1].fraction * statsBarLength + "px")
    +b.pie
      +e.text
        +e('strong').percents #{Math.round(stats.recommendFraction * 100)}%
        +e('span').advice Пользователей рекомендуют эти курсы

  +b('section').course-feedbacks._loading
    +e.head
      +e('h2').title(hidden data-feedback-count)
        +e('span').title-n
        +e('span').title-t
      +e.select
        +b('select')(name="teacherId").input-select._small.__control
          +e('option').option(value="" selected) все преподаватели
          each teacher in teachers
            +e('option').option(value=teacher._id)= teacher.displayName
      +e.select
        +b('select')(name="stars").input-select._small.__control
          +e('option').option(value="all" selected) с любой оценкой
          +e('option').option(value="5") с оценкой 5
          +e('option').option(value="4") с оценкой 4
          +e('option').option(value="3") с оценкой 3
          +e('option').option(value="4") с оценкой 4
          +e('option').option(value="1") с оценкой 1

    +e.feedbacks-list(data-feedback-container)

    +e.loader
      +b.page-loader
        +b('span').spinner._active._small
          +e('span').dot._1
          +e('span').dot._2
          +e('span').dot._3

  script window.FEEDBACK_LIST_INIT={ elem: document.querySelector('.course-feedbacks'), filter: { course: "#{course.slug}" } };
