{"version":3,"sources":["webpack:///./handlers/ebook/client/index.js","webpack:///./client/xhr.js","webpack:///./handlers/ebook/client/orderForm.js","webpack:///./client/getCsrfCookie.js","webpack:///./handlers/payments/common/client/index.js","webpack:///./handlers/payments/common/client/formPayment.js"],"names":[],"mappings":"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","file":"ebook.5e816467487192ac2e2b.js","sourcesContent":["var OrderForm = require('./orderForm');\n\nexports.init = function() {\n\n\n  var orderForm = document.querySelector('[data-order-form]');\n  if (orderForm) {\n    new OrderForm({\n      elem: orderForm\n    });\n  }\n\n};\n\n\n/** WEBPACK FOOTER **\n ** ./handlers/ebook/client/index.js\n **/","var notification = require('client/notification');\nvar getCsrfCookie = require('client/getCsrfCookie');\n// Wrapper about XHR\n// # Global Events\n// triggers document.loadstart/loadend on communication start/end\n//    --> unless options.noGlobalEvents is set\n//\n// # Events\n// triggers fail/success on load end:\n//    --> by default status=200 is ok, the others are failures\n//    --> options.normalStatuses = [201,409] allow given statuses\n//    --> fail event has .reason field\n//    --> success event has .result field\n//\n// # JSON\n//    --> send(object) calls JSON.stringify\n//    --> adds Accept: json (we want json) by default, unless options.raw\n// if options.json or server returned json content type\n//    --> autoparse json\n//    --> fail if error\n//\n// # CSRF\n//    --> requests sends header X-XSRF-TOKEN from cookie\n\nfunction xhr(options) {\n\n  var request = new XMLHttpRequest();\n\n  var method = options.method || 'GET';\n\n  var body = options.body;\n  var url = options.url;\n\n  request.open(method, url, options.sync ? false : true);\n\n  request.method = method;\n\n  // token/header names same as angular $http for easier interop\n  var csrfCookie = getCsrfCookie();\n  if (csrfCookie && !options.skipCsrf) {\n    request.setRequestHeader(\"X-XSRF-TOKEN\", csrfCookie);\n  }\n\n  if ({}.toString.call(body) == '[object Object]') {\n    // must be OPENed to setRequestHeader\n    request.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n    body = JSON.stringify(body);\n  }\n\n  if (!options.noDocumentEvents) {\n    request.addEventListener('loadstart', event => {\n      request.timeStart = Date.now();\n      var e = wrapEvent('xhrstart', event);\n      document.dispatchEvent(e);\n    });\n    request.addEventListener('loadend', event => {\n      var e = wrapEvent('xhrend', event);\n      document.dispatchEvent(e);\n    });\n    request.addEventListener('success', event => {\n      var e = wrapEvent('xhrsuccess', event);\n      e.result = event.result;\n      document.dispatchEvent(e);\n    });\n    request.addEventListener('fail', event => {\n      var e = wrapEvent('xhrfail', event);\n      e.reason = event.reason;\n      document.dispatchEvent(e);\n    });\n  }\n\n  if (!options.raw) { // means we want json\n    request.setRequestHeader(\"Accept\", \"application/json\");\n  }\n\n  request.setRequestHeader('X-Requested-With', \"XMLHttpRequest\");\n\n  var normalStatuses = options.normalStatuses || [200];\n\n  function wrapEvent(name, e) {\n    var event = new CustomEvent(name);\n    event.originalEvent = e;\n    return event;\n  }\n\n  function fail(reason, originalEvent) {\n    var e = wrapEvent(\"fail\", originalEvent);\n    e.reason = reason;\n    request.dispatchEvent(e);\n  }\n\n  function success(result, originalEvent) {\n    var e = wrapEvent(\"success\", originalEvent);\n    e.result = result;\n    request.dispatchEvent(e);\n  }\n\n  request.addEventListener(\"error\", e => {\n    fail(\"Ошибка связи с сервером.\", e);\n  });\n\n  request.addEventListener(\"timeout\", e => {\n    fail(\"Превышено максимально допустимое время ожидания ответа от сервера.\", e);\n  });\n\n  request.addEventListener(\"abort\", e => {\n    fail(\"Запрос был прерван.\", e);\n  });\n\n  request.addEventListener(\"load\", e => {\n    if (!request.status) { // does that ever happen?\n      fail(\"Не получен ответ от сервера.\", e);\n      return;\n    }\n\n    if (normalStatuses.indexOf(request.status) == -1) {\n      fail(\"Ошибка на стороне сервера (код \" + request.status + \"), попытайтесь позднее\", e);\n      return;\n    }\n\n    var result = request.responseText;\n    var contentType = request.getResponseHeader(\"Content-Type\");\n    if (contentType.match(/^application\\/json/) || options.json) { // autoparse json if WANT or RECEIVED json\n      try {\n        result = JSON.parse(result);\n      } catch (e) {\n        fail(\"Некорректный формат ответа от сервера\", e);\n        return;\n      }\n    }\n\n    success(result, e);\n  });\n\n  // defer to let other handlers be assigned\n  setTimeout(function() {\n    request.send(body);\n  }, 0);\n\n\n\n\n  return request;\n\n}\n\n\ndocument.addEventListener('xhrfail', function(event) {\n  new notification.Error(event.reason);\n});\n\n\nmodule.exports = xhr;\n\n\n\n/** WEBPACK FOOTER **\n ** ./client/xhr.js\n **/","var xhr = require('client/xhr');\nvar notification = require('client/notification');\nvar delegate = require('client/delegate');\nvar FormPayment = require('payments/common/client').FormPayment;\nvar Spinner = require('client/spinner');\nvar Modal = require('client/head/modal');\n\nclass OrderForm {\n\n  constructor(options) {\n    this.elem = options.elem;\n\n    this.product = 'ebook';\n\n    this.elem.addEventListener('submit', (e) => this.onSubmit(e));\n\n\n    this.delegate('[data-order-payment-change]', 'click', function(e) {\n      e.preventDefault();\n      this.elem.querySelector('[data-order-form-step-payment]').style.display = 'block';\n      this.elem.querySelector('[data-order-form-step-confirm]').style.display = 'none';\n      this.elem.querySelector('[data-order-form-step-receipt]').style.display = 'none';\n    });\n\n    this.delegate('.complex-form__extract .extract__item', 'click', function(e) {\n      e.delegateTarget.querySelector('[type=\"radio\"]').checked = true;\n    });\n  }\n\n\n  onSubmit(event) {\n    event.preventDefault();\n    new FormPayment(this, this.elem.querySelector('.pay-method')).submit();\n  }\n\n\n  // return orderData or nothing if validation failed\n  getOrderData() {\n    var orderData = {    };\n\n    if (window.orderNumber) {\n      orderData.orderNumber = window.orderNumber;\n    } else {\n      var chooser = this.elem.querySelector('input[name=\"orderTemplate\"]:checked');\n      orderData.orderTemplate = chooser.value;\n      orderData.amount = chooser.dataset.amount; // for stats\n    }\n\n    if (this.elem.elements.email) {\n      if (!this.elem.elements.email.value) {\n        window.ga('send', 'event', 'payment', 'checkout-no-email', 'ebook');\n        window.metrika.reachGoal('CHECKOUT-NO-EMAIL', {product: 'ebook'});\n        new notification.Error(\"Введите email.\");\n        this.elem.elements.email.scrollIntoView();\n        setTimeout(function() {\n          window.scrollBy(0, -200);\n        }, 0);\n        this.elem.elements.email.focus();\n        return;\n      } else {\n        orderData.email = this.elem.elements.email.value;\n      }\n    }\n\n    return orderData;\n  }\n\n\n\n}\n\n\ndelegate.delegateMixin(OrderForm.prototype);\n\nmodule.exports = OrderForm;\n\n\n\n/** WEBPACK FOOTER **\n ** ./handlers/ebook/client/orderForm.js\n **/","module.exports = function() {\n  var csrfCookie = document.cookie.match(/XSRF-TOKEN=([\\w-]+)/);\n  return csrfCookie ? csrfCookie[1] : null;\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./client/getCsrfCookie.js\n **/","exports.FormPayment = require('./formPayment');\n\n\n\n/** WEBPACK FOOTER **\n ** ./handlers/payments/common/client/index.js\n **/","var notification = require('client/notification');\nvar xhr = require('client/xhr');\nvar Spinner = require('client/spinner');\nvar Modal = require('client/head/modal');\n\n/**\n * Get data from orderForm.getOrderData()\n * process payment, ask for more data if needed\n */\nclass FormPayment {\n\n  constructor(orderForm, paymentMethodElem) {\n    this.orderForm = orderForm;\n    this.paymentMethodElem = paymentMethodElem;\n  }\n\n  request(options) {\n    var request = xhr(options);\n\n    request.addEventListener('loadstart', function() {\n      var onEnd = this.startRequestIndication();\n      request.addEventListener('loadend', onEnd);\n    }.bind(this));\n\n    return request;\n  }\n\n  startRequestIndication() {\n\n    this.paymentMethodElem.classList.add('modal-overlay_light');\n\n    var spinner = new Spinner({\n      elem:  this.paymentMethodElem,\n      size:  'medium',\n      class: 'pay-method__spinner'\n    });\n    spinner.start();\n\n    return () => {\n      this.paymentMethodElem.classList.remove('modal-overlay_light');\n      if (spinner) spinner.stop();\n    };\n\n  }\n\n  readPaymentData() {\n    var paymentData = {};\n\n    [].forEach.call(this.paymentMethodElem.querySelectorAll('input,select,textarea'), function(elem) {\n      if ( (elem.type == 'radio' || elem.type == 'checkbox') && !elem.checked) return;\n      paymentData[elem.name] = elem.value;\n    });\n\n    return paymentData;\n  }\n\n  submit() {\n\n    var orderData = this.orderForm.getOrderData();\n    if (!orderData) return;\n\n    var paymentData = this.readPaymentData();\n\n    if (!paymentData.paymentMethod) {\n      new notification.Error(\"Выберите метод оплаты.\");\n      return;\n    }\n\n    if (paymentData.paymentMethod == 'invoice' && !paymentData.invoiceCompanyName) {\n      new notification.Error(\"Укажите название компании.\");\n      this.paymentMethodElem.querySelector('[name=\"invoiceCompanyName\"]').focus();\n      return;\n    }\n\n    for (var key in paymentData) {\n      orderData[key] = paymentData[key];\n    }\n\n    // response status must be 200\n    var request = xhr({\n      method:         'POST',\n      url:            '/payments/common/checkout',\n      normalStatuses: [200, 403, 400],\n      body:           orderData\n    });\n\n    if (orderData.orderTemplate) {\n      window.ga('ec:addProduct', {\n        id:       this.orderForm.product,\n        variant:  orderData.orderTemplate,\n        price:    orderData.amount,\n        quantity: 1\n      });\n    }\n\n    window.ga('ec:setAction', 'checkout', {\n      step:   1,\n      option: orderData.paymentMethod\n    });\n\n    window.metrika.reachGoal('CHECKOUT', {\n      product: this.orderForm.product,\n      method:  orderData.paymentMethod,\n      price:   orderData.amount\n    });\n\n    window.ga('send', 'event', 'payment', 'checkout', 'ebook');\n    window.ga('send', 'event', 'payment', 'checkout-method-' + orderData.paymentMethod, this.orderForm.product);\n\n    var onEnd = this.startRequestIndication();\n\n    request.addEventListener('success', (event) => {\n\n      if (request.status == 403) {\n        new notification.Error(\"<p>\" + (event.result.description || event.result.message) + \"</p><p>Пожалуйста, начните оформление заново.</p><p>Если вы считаете, что на сервере ошибка &mdash; свяжитесь со <a href='mailto:orders@javascript.ru'>службой поддержки</a>.</p>\");\n        onEnd();\n        return;\n      }\n\n      if (request.status == 400) {\n        new notification.Error(\"<p>\" + event.result.message + \"</p><p>Если вы считаете, что произошла ошибка &mdash; свяжитесь со <a href='mailto:orders@javascript.ru'>службой поддержки</a>.</p>\");\n        onEnd();\n        return;\n      }\n\n      var result = event.result;\n\n      if (result.form) {\n        // don't stop the spinner while submitting the form to the payment system!\n        // (still in progress)\n\n        window.ga('ec:setAction', 'purchase', {\n          id: result.orderNumber\n        });\n\n        var container = document.createElement('div');\n        container.hidden = true;\n        container.innerHTML = result.form;\n        document.body.appendChild(container);\n\n\n        // submit form after GA or after 500ms, which one comes sooner\n        var submitForm = function() {\n          if (!submitForm.called) {\n            submitForm.called = true;\n            container.firstChild.submit();\n          }\n        };\n\n        window.ga('send', 'event', 'payment', 'purchase', 'ebook', {\n          hitCallback: submitForm\n        });\n        setTimeout(submitForm, 500);\n\n\n        window.metrika.reachGoal('PURCHASE', {\n          product: this.orderForm.product,\n          method:  orderData.paymentMethod,\n          price:   orderData.amount,\n          number:  result.orderNumber\n        });\n\n\n      } else {\n        console.error(result);\n        onEnd();\n        new notification.Error(\"Ошибка на сервере, свяжитесь со <a href='mailto:orders@javascript.ru'>службой поддержки</a>.\");\n      }\n    });\n\n    request.addEventListener('fail', onEnd);\n  }\n}\n\nmodule.exports = FormPayment;\n\n\n\n/** WEBPACK FOOTER **\n ** ./handlers/payments/common/client/formPayment.js\n **/"],"sourceRoot":""}