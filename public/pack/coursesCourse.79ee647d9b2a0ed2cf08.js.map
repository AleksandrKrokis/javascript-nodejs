{"version":3,"sources":["webpack:///coursesCourse.79ee647d9b2a0ed2cf08.js","webpack:///./handlers/courses/client/course/index.js","webpack:///./client/xhr.js","webpack:///./handlers/newsletter/client/index.js","webpack:///./client/getCsrfCookie.js"],"names":["coursesCourse","webpackJsonp_name_","module","exports","__webpack_require__","initNewsletterForm","form","document","querySelector","onsubmit","event","preventDefault","newsletter","submitSubscribeForm","initSignupButton","link","onclick","window","currentUser","spinner","Spinner","elem","size","class","elemClass","start","e","stop","AuthModal","callback","location","href","init",29,"xhr","options","wrapEvent","name","CustomEvent","originalEvent","fail","reason","request","dispatchEvent","success","result","XMLHttpRequest","method","body","url","open","sync","csrfCookie","getCsrfCookie","skipCsrf","setRequestHeader","toString","call","JSON","stringify","noDocumentEvents","addEventListener","timeStart","Date","now","raw","normalStatuses","status","indexOf","responseText","contentType","getResponseHeader","match","json","parse","setTimeout","send","notification","Error",61,"onSuccess","elements","email","value","action","slug","submitButton","disabled","formLabel","getAttribute","this","metrika","reachGoal","ga","Success","message",78,"cookie"],"mappings":"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","file":"coursesCourse.79ee647d9b2a0ed2cf08.js","sourcesContent":["var coursesCourse =\nwebpackJsonp_name_([1],{\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar newsletter = __webpack_require__(61);\n\tvar Spinner = __webpack_require__(54);\n\tvar xhr = __webpack_require__(29);\n\t\n\texports.init = function () {\n\t\n\t  initNewsletterForm();\n\t\n\t  initSignupButton();\n\t};\n\t\n\tfunction initNewsletterForm() {\n\t\n\t  var form = document.querySelector('[data-newsletter-subscribe-form]');\n\t  if (!form) return;\n\t\n\t  form.onsubmit = function (event) {\n\t    event.preventDefault();\n\t    newsletter.submitSubscribeForm(form);\n\t  };\n\t}\n\t\n\tfunction initSignupButton() {\n\t\n\t  var link = document.querySelector('[data-group-signup-link]');\n\t  if (!link) return;\n\t\n\t  link.onclick = function (event) {\n\t\n\t    if (window.currentUser) {\n\t      return;\n\t    }\n\t\n\t    event.preventDefault();\n\t\n\t    var spinner = new Spinner({\n\t      elem: link,\n\t      size: 'small',\n\t      'class': 'submit-button__spinner',\n\t      elemClass: 'submit-button_progress'\n\t    });\n\t    spinner.start();\n\t\n\t    __webpack_require__.e/* nsure */(2, function () {\n\t      spinner.stop();\n\t      var AuthModal = __webpack_require__(60).AuthModal;\n\t      new AuthModal({\n\t        callback: function callback() {\n\t          window.location.href = link.href;\n\t        }\n\t      });\n\t    });\n\t  };\n\t}\n\n/***/ },\n\n/***/ 29:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar notification = __webpack_require__(24);\n\tvar getCsrfCookie = __webpack_require__(78);\n\t// Wrapper about XHR\n\t// # Global Events\n\t// triggers document.loadstart/loadend on communication start/end\n\t//    --> unless options.noGlobalEvents is set\n\t//\n\t// # Events\n\t// triggers fail/success on load end:\n\t//    --> by default status=200 is ok, the others are failures\n\t//    --> options.normalStatuses = [201,409] allow given statuses\n\t//    --> fail event has .reason field\n\t//    --> success event has .result field\n\t//\n\t// # JSON\n\t//    --> send(object) calls JSON.stringify\n\t//    --> adds Accept: json (we want json) by default, unless options.raw\n\t// if options.json or server returned json content type\n\t//    --> autoparse json\n\t//    --> fail if error\n\t//\n\t// # CSRF\n\t//    --> requests sends header X-XSRF-TOKEN from cookie\n\t\n\tfunction xhr(options) {\n\t\n\t  var request = new XMLHttpRequest();\n\t\n\t  var method = options.method || 'GET';\n\t\n\t  var body = options.body;\n\t  var url = options.url;\n\t\n\t  request.open(method, url, options.sync ? false : true);\n\t\n\t  request.method = method;\n\t\n\t  // token/header names same as angular $http for easier interop\n\t  var csrfCookie = getCsrfCookie();\n\t  if (csrfCookie && !options.skipCsrf) {\n\t    request.setRequestHeader('X-XSRF-TOKEN', csrfCookie);\n\t  }\n\t\n\t  if (({}).toString.call(body) == '[object Object]') {\n\t    // must be OPENed to setRequestHeader\n\t    request.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');\n\t    body = JSON.stringify(body);\n\t  }\n\t\n\t  if (!options.noDocumentEvents) {\n\t    request.addEventListener('loadstart', function (event) {\n\t      request.timeStart = Date.now();\n\t      var e = wrapEvent('xhrstart', event);\n\t      document.dispatchEvent(e);\n\t    });\n\t    request.addEventListener('loadend', function (event) {\n\t      var e = wrapEvent('xhrend', event);\n\t      document.dispatchEvent(e);\n\t    });\n\t    request.addEventListener('success', function (event) {\n\t      var e = wrapEvent('xhrsuccess', event);\n\t      e.result = event.result;\n\t      document.dispatchEvent(e);\n\t    });\n\t    request.addEventListener('fail', function (event) {\n\t      var e = wrapEvent('xhrfail', event);\n\t      e.reason = event.reason;\n\t      document.dispatchEvent(e);\n\t    });\n\t  }\n\t\n\t  if (!options.raw) {\n\t    // means we want json\n\t    request.setRequestHeader('Accept', 'application/json');\n\t  }\n\t\n\t  request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\t\n\t  var normalStatuses = options.normalStatuses || [200];\n\t\n\t  function wrapEvent(name, e) {\n\t    var event = new CustomEvent(name);\n\t    event.originalEvent = e;\n\t    return event;\n\t  }\n\t\n\t  function fail(reason, originalEvent) {\n\t    var e = wrapEvent('fail', originalEvent);\n\t    e.reason = reason;\n\t    request.dispatchEvent(e);\n\t  }\n\t\n\t  function success(result, originalEvent) {\n\t    var e = wrapEvent('success', originalEvent);\n\t    e.result = result;\n\t    request.dispatchEvent(e);\n\t  }\n\t\n\t  request.addEventListener('error', function (e) {\n\t    fail('Ошибка связи с сервером.', e);\n\t  });\n\t\n\t  request.addEventListener('timeout', function (e) {\n\t    fail('Превышено максимально допустимое время ожидания ответа от сервера.', e);\n\t  });\n\t\n\t  request.addEventListener('abort', function (e) {\n\t    fail('Запрос был прерван.', e);\n\t  });\n\t\n\t  request.addEventListener('load', function (e) {\n\t    if (!request.status) {\n\t      // does that ever happen?\n\t      fail('Не получен ответ от сервера.', e);\n\t      return;\n\t    }\n\t\n\t    if (normalStatuses.indexOf(request.status) == -1) {\n\t      fail('Ошибка на стороне сервера (код ' + request.status + '), попытайтесь позднее', e);\n\t      return;\n\t    }\n\t\n\t    var result = request.responseText;\n\t    var contentType = request.getResponseHeader('Content-Type');\n\t    if (contentType.match(/^application\\/json/) || options.json) {\n\t      // autoparse json if WANT or RECEIVED json\n\t      try {\n\t        result = JSON.parse(result);\n\t      } catch (e) {\n\t        fail('Некорректный формат ответа от сервера', e);\n\t        return;\n\t      }\n\t    }\n\t\n\t    success(result, e);\n\t  });\n\t\n\t  // defer to let other handlers be assigned\n\t  setTimeout(function () {\n\t    request.send(body);\n\t  }, 0);\n\t\n\t  return request;\n\t}\n\t\n\tdocument.addEventListener('xhrfail', function (event) {\n\t  new notification.Error(event.reason);\n\t});\n\t\n\tmodule.exports = xhr;\n\n/***/ },\n\n/***/ 61:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar Spinner = __webpack_require__(54);\n\tvar xhr = __webpack_require__(29);\n\tvar notification = __webpack_require__(24);\n\t\n\tfunction init() {}\n\t\n\tfunction submitSubscribeForm(form, onSuccess) {\n\t\n\t  if (!form.elements.email.value) {\n\t    return;\n\t  }\n\t\n\t  var request = xhr({\n\t    method: 'POST',\n\t    url: form.action,\n\t    body: {\n\t      email: form.elements.email.value,\n\t      slug: form.elements.slug.value\n\t    }\n\t  });\n\t\n\t  var submitButton = form.querySelector('[type=\"submit\"]');\n\t\n\t  var spinner = new Spinner({\n\t    elem: submitButton,\n\t    size: 'small',\n\t    elemClass: 'button_loading'\n\t  });\n\t  spinner.start();\n\t  submitButton.disabled = true;\n\t\n\t  request.addEventListener('loadend', function () {\n\t    spinner.stop();\n\t    submitButton.disabled = false;\n\t  });\n\t\n\t  var formLabel = form.getAttribute('data-newsletter-subscribe-form');\n\t\n\t  request.addEventListener('success', function (event) {\n\t    if (this.status == 200) {\n\t\n\t      window.metrika.reachGoal('NEWSLETTER-SUBSCRIBE', {\n\t        form: formLabel\n\t      });\n\t      window.ga('send', 'event', 'newsletter', 'subscribe', formLabel);\n\t\n\t      new notification.Success(event.result.message, 'slow');\n\t      onSuccess && onSuccess();\n\t    } else {\n\t\n\t      window.metrika.reachGoal('NEWSLETTER-SUBSCRIBE-FAIL', {\n\t        form: formLabel\n\t      });\n\t      window.ga('send', 'event', 'newsletter', 'subscribe-fail', formLabel);\n\t\n\t      new notification.Error(event.result.message);\n\t    }\n\t  });\n\t}\n\t\n\texports.init = init;\n\texports.submitSubscribeForm = submitSubscribeForm;\n\n/***/ },\n\n/***/ 78:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tmodule.exports = function () {\n\t  var csrfCookie = document.cookie.match(/XSRF-TOKEN=([\\w-]+)/);\n\t  return csrfCookie ? csrfCookie[1] : null;\n\t};\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** coursesCourse.79ee647d9b2a0ed2cf08.js\n **/","var newsletter = require('newsletter/client');\nvar Spinner = require('client/spinner');\nvar xhr = require('client/xhr');\n\nexports.init = function() {\n\n  initNewsletterForm();\n\n  initSignupButton();\n\n};\n\nfunction initNewsletterForm() {\n\n  var form = document.querySelector('[data-newsletter-subscribe-form]');\n  if (!form) return;\n\n  form.onsubmit = function(event) {\n    event.preventDefault();\n    newsletter.submitSubscribeForm(form);\n  };\n\n}\n\nfunction initSignupButton() {\n\n  var link = document.querySelector('[data-group-signup-link]');\n  if (!link) return;\n\n  link.onclick = function(event) {\n\n    if (window.currentUser) {\n      return;\n    }\n\n    event.preventDefault();\n\n    var spinner = new Spinner({\n      elem:      link,\n      size:      'small',\n      class:     'submit-button__spinner',\n      elemClass: 'submit-button_progress'\n    });\n    spinner.start();\n\n    require.ensure('auth/client', function() {\n      spinner.stop();\n      var AuthModal = require('auth/client').AuthModal;\n      new AuthModal({\n        callback: function() {\n          window.location.href = link.href;\n        }\n      });\n    }, 'authClient');\n  };\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./handlers/courses/client/course/index.js\n **/","var notification = require('client/notification');\nvar getCsrfCookie = require('client/getCsrfCookie');\n// Wrapper about XHR\n// # Global Events\n// triggers document.loadstart/loadend on communication start/end\n//    --> unless options.noGlobalEvents is set\n//\n// # Events\n// triggers fail/success on load end:\n//    --> by default status=200 is ok, the others are failures\n//    --> options.normalStatuses = [201,409] allow given statuses\n//    --> fail event has .reason field\n//    --> success event has .result field\n//\n// # JSON\n//    --> send(object) calls JSON.stringify\n//    --> adds Accept: json (we want json) by default, unless options.raw\n// if options.json or server returned json content type\n//    --> autoparse json\n//    --> fail if error\n//\n// # CSRF\n//    --> requests sends header X-XSRF-TOKEN from cookie\n\nfunction xhr(options) {\n\n  var request = new XMLHttpRequest();\n\n  var method = options.method || 'GET';\n\n  var body = options.body;\n  var url = options.url;\n\n  request.open(method, url, options.sync ? false : true);\n\n  request.method = method;\n\n  // token/header names same as angular $http for easier interop\n  var csrfCookie = getCsrfCookie();\n  if (csrfCookie && !options.skipCsrf) {\n    request.setRequestHeader(\"X-XSRF-TOKEN\", csrfCookie);\n  }\n\n  if ({}.toString.call(body) == '[object Object]') {\n    // must be OPENed to setRequestHeader\n    request.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n    body = JSON.stringify(body);\n  }\n\n  if (!options.noDocumentEvents) {\n    request.addEventListener('loadstart', event => {\n      request.timeStart = Date.now();\n      var e = wrapEvent('xhrstart', event);\n      document.dispatchEvent(e);\n    });\n    request.addEventListener('loadend', event => {\n      var e = wrapEvent('xhrend', event);\n      document.dispatchEvent(e);\n    });\n    request.addEventListener('success', event => {\n      var e = wrapEvent('xhrsuccess', event);\n      e.result = event.result;\n      document.dispatchEvent(e);\n    });\n    request.addEventListener('fail', event => {\n      var e = wrapEvent('xhrfail', event);\n      e.reason = event.reason;\n      document.dispatchEvent(e);\n    });\n  }\n\n  if (!options.raw) { // means we want json\n    request.setRequestHeader(\"Accept\", \"application/json\");\n  }\n\n  request.setRequestHeader('X-Requested-With', \"XMLHttpRequest\");\n\n  var normalStatuses = options.normalStatuses || [200];\n\n  function wrapEvent(name, e) {\n    var event = new CustomEvent(name);\n    event.originalEvent = e;\n    return event;\n  }\n\n  function fail(reason, originalEvent) {\n    var e = wrapEvent(\"fail\", originalEvent);\n    e.reason = reason;\n    request.dispatchEvent(e);\n  }\n\n  function success(result, originalEvent) {\n    var e = wrapEvent(\"success\", originalEvent);\n    e.result = result;\n    request.dispatchEvent(e);\n  }\n\n  request.addEventListener(\"error\", e => {\n    fail(\"Ошибка связи с сервером.\", e);\n  });\n\n  request.addEventListener(\"timeout\", e => {\n    fail(\"Превышено максимально допустимое время ожидания ответа от сервера.\", e);\n  });\n\n  request.addEventListener(\"abort\", e => {\n    fail(\"Запрос был прерван.\", e);\n  });\n\n  request.addEventListener(\"load\", e => {\n    if (!request.status) { // does that ever happen?\n      fail(\"Не получен ответ от сервера.\", e);\n      return;\n    }\n\n    if (normalStatuses.indexOf(request.status) == -1) {\n      fail(\"Ошибка на стороне сервера (код \" + request.status + \"), попытайтесь позднее\", e);\n      return;\n    }\n\n    var result = request.responseText;\n    var contentType = request.getResponseHeader(\"Content-Type\");\n    if (contentType.match(/^application\\/json/) || options.json) { // autoparse json if WANT or RECEIVED json\n      try {\n        result = JSON.parse(result);\n      } catch (e) {\n        fail(\"Некорректный формат ответа от сервера\", e);\n        return;\n      }\n    }\n\n    success(result, e);\n  });\n\n  // defer to let other handlers be assigned\n  setTimeout(function() {\n    request.send(body);\n  }, 0);\n\n  return request;\n\n}\n\n\ndocument.addEventListener('xhrfail', function(event) {\n  new notification.Error(event.reason);\n});\n\n\nmodule.exports = xhr;\n\n\n\n/** WEBPACK FOOTER **\n ** ./client/xhr.js\n **/","var Spinner = require('client/spinner');\nvar xhr = require('client/xhr');\nvar notification = require('client/notification');\n\nfunction init() {\n\n\n}\n\nfunction submitSubscribeForm(form, onSuccess) {\n\n  if (!form.elements.email.value) {\n    return;\n  }\n\n  const request = xhr({\n    method: 'POST',\n    url:    form.action,\n    body:   {\n      email: form.elements.email.value,\n      slug: form.elements.slug.value\n    }\n  });\n\n  var submitButton = form.querySelector('[type=\"submit\"]');\n\n  var spinner = new Spinner({\n    elem:      submitButton,\n    size:      'small',\n    elemClass: 'button_loading'\n  });\n  spinner.start();\n  submitButton.disabled = true;\n\n  request.addEventListener('loadend', ()=> {\n    spinner.stop();\n    submitButton.disabled = false;\n  });\n\n  var formLabel = form.getAttribute('data-newsletter-subscribe-form');\n\n  request.addEventListener('success', function(event) {\n    if (this.status == 200) {\n\n      window.metrika.reachGoal('NEWSLETTER-SUBSCRIBE', {\n        form: formLabel\n      });\n      window.ga('send', 'event', 'newsletter', 'subscribe', formLabel);\n\n      new notification.Success(event.result.message, 'slow');\n      onSuccess && onSuccess();\n    } else {\n\n      window.metrika.reachGoal('NEWSLETTER-SUBSCRIBE-FAIL', {\n        form: formLabel\n      });\n      window.ga('send', 'event', 'newsletter', 'subscribe-fail', formLabel);\n\n      new notification.Error(event.result.message);\n    }\n  });\n\n}\n\nexports.init = init;\nexports.submitSubscribeForm = submitSubscribeForm;\n\n\n\n/** WEBPACK FOOTER **\n ** ./handlers/newsletter/client/index.js\n **/","module.exports = function() {\n  var csrfCookie = document.cookie.match(/XSRF-TOKEN=([\\w-]+)/);\n  return csrfCookie ? csrfCookie[1] : null;\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./client/getCsrfCookie.js\n **/"],"sourceRoot":""}